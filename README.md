# –°–∏—Å—Ç–µ–º–∞ —Å—Ç–∞–≤–æ–∫ –Ω–∞ —Å–ø–æ—Ä—Ç–∏–≤–Ω—ñ –ø–æ–¥—ñ—ó

## –ü—Ä–æ—î–∫—Ç –∑ –ø—Ä–µ–¥–º–µ—Ç—É "–†–æ–∑–ø–æ–¥—ñ–ª–µ–Ω—ñ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ–π–Ω—ñ —Å–∏—Å—Ç–µ–º–∏"

–ü—Ä–æ–¥—É–∫—Ü—ñ–π–Ω–∞ REST API –¥–ª—è —Å–∏—Å—Ç–µ–º–∏ —Å—Ç–∞–≤–æ–∫ –Ω–∞ —Å–ø–æ—Ä—Ç–∏–≤–Ω—ñ –ø–æ–¥—ñ—ó, –ø–æ–±—É–¥–æ–≤–∞–Ω–∞ –∑ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è–º FastAPI, PostgreSQL —Ç–∞ Nginx. –°–∏—Å—Ç–µ–º–∞ –ø—ñ–¥—Ç—Ä–∏–º—É—î —Ä–æ–∑–ø–æ–¥—ñ–ª–µ–Ω—É –∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä—É –∑ —Ä–µ–ø–ª—ñ–∫–∞—Ü—ñ—î—é –±–∞–∑–∏ –¥–∞–Ω–∏—Ö —Ç–∞ –±–∞–ª–∞–Ω—Å—É–≤–∞–Ω–Ω—è–º –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –º—ñ–∂ –∫—ñ–ª—å–∫–æ–º–∞ –µ–∫–∑–µ–º–ø–ª—è—Ä–∞–º–∏ —Å–µ—Ä–≤–µ—Ä—É.

## üèóÔ∏è –ê—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞

- **–§—Ä–µ–π–º–≤–æ—Ä–∫**: FastAPI (Python 3.11+)
- **–ë–∞–∑–∞ –¥–∞–Ω–∏—Ö**: PostgreSQL 18 –∑ —Ä–µ–ø–ª—ñ–∫–∞—Ü—ñ—î—é (1 –º–∞–π—Å—Ç–µ—Ä + 3 —Ä–µ–ø–ª—ñ–∫–∏)
- **ORM**: SQLAlchemy (Async) –∑ –º—ñ–≥—Ä–∞—Ü—ñ—è–º–∏ Alembic
- **–ê—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—è**: JWT (JSON Web Tokens)
- **Reverse Proxy**: Nginx (–ø–æ—Ä—Ç 80)
- **API Server**: Uvicorn (–ø–æ—Ä—Ç 8000)
- **–î–µ–ø–ª–æ–π–º–µ–Ω—Ç**: Docker Compose

## ‚ú® –ö–ª—é—á–æ–≤—ñ –º–æ–∂–ª–∏–≤–æ—Å—Ç—ñ

- üîê **–ê—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—è**: JWT –∑ —Ö–µ—à—É–≤–∞–Ω–Ω—è–º –ø–∞—Ä–æ–ª—ñ–≤ Bcrypt
- üë• **–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—è**: –†–æ–ª—å–æ–≤–∏–π –∫–æ–Ω—Ç—Ä–æ–ª—å –¥–æ—Å—Ç—É–ø—É (–∞–¥–º—ñ–Ω/–∫–æ—Ä–∏—Å—Ç—É–≤–∞—á)
- üóÑÔ∏è **–ë–∞–∑–∞ –¥–∞–Ω–∏—Ö**: –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∏–π SQLAlchemy –∑ PostgreSQL
- ‚úÖ **–í–∞–ª—ñ–¥–∞—Ü—ñ—è**: Pydantic –º–æ–¥–µ–ª—ñ –¥–ª—è –∑–∞–ø–∏—Ç—ñ–≤/–≤—ñ–¥–ø–æ–≤—ñ–¥–µ–π
- üìö **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è**: –ê–≤—Ç–æ–≥–µ–Ω–µ—Ä–æ–≤–∞–Ω–∞ Swagger UI —Ç–∞ ReDoc
- üîÑ **–†–µ–ø–ª—ñ–∫–∞—Ü—ñ—è**: PostgreSQL –º–∞–π—Å—Ç–µ—Ä-—Ä–µ–ø–ª—ñ–∫–∞ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è
- üê≥ **–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü—ñ—è**: Docker Compose –∑ Nginx reverse proxy
- üöÄ **–ü—Ä–æ–¥—É–∫—Ü—ñ–π–Ω–∞ –≥–æ—Ç–æ–≤–Ω—ñ—Å—Ç—å**: –ú–∞—Å—à—Ç–∞–±–æ–≤–∞–Ω–∞, –±–µ–∑–ø–µ—á–Ω–∞ –∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ—î–∫—Ç—É

```
src/ukma/betting_system/
‚îú‚îÄ‚îÄ main.py              # –¢–æ—á–∫–∞ –≤—Ö–æ–¥—É FastAPI –¥–æ–¥–∞—Ç–∫—É
‚îú‚îÄ‚îÄ models.py            # SQLAlchemy –º–æ–¥–µ–ª—ñ –±–∞–∑–∏ –¥–∞–Ω–∏—Ö
‚îú‚îÄ‚îÄ schemas.py           # Pydantic —Å—Ö–µ–º–∏ –∑–∞–ø–∏—Ç—ñ–≤/–≤—ñ–¥–ø–æ–≤—ñ–¥–µ–π
‚îú‚îÄ‚îÄ core.py              # JWT —Ç–∞ —É—Ç–∏–ª—ñ—Ç–∏ —Ö–µ—à—É–≤–∞–Ω–Ω—è –ø–∞—Ä–æ–ª—ñ–≤
‚îú‚îÄ‚îÄ db.py                # –ü—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –¥–æ –±–∞–∑–∏ –¥–∞–Ω–∏—Ö
‚îî‚îÄ‚îÄ routers/
    ‚îú‚îÄ‚îÄ auth.py          # –ï–Ω–¥–ø–æ—ñ–Ω—Ç–∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó
    ‚îú‚îÄ‚îÄ bets.py          # –ï–Ω–¥–ø–æ—ñ–Ω—Ç–∏ —Å—Ç–∞–≤–æ–∫
    ‚îî‚îÄ‚îÄ events.py        # –ï–Ω–¥–ø–æ—ñ–Ω—Ç–∏ –ø–æ–¥—ñ–π
```

### –ü–µ—Ä–µ–¥—É–º–æ–≤–∏
- Docker —Ç–∞ Docker Compose

### 1. –ö–ª–æ–Ω—É–≤–∞–Ω–Ω—è —Ç–∞ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è

```bash
git clone <repository-url>
cd sports-betting-system
cp .env.example .env # .env —Ñ–∞–π–ª –∑ –≤–∞—à–∏–º–∏ –∫–æ–Ω—Ñ—ñ–≥–∞–º–∏ –ë–î
```

### 2. –ó–∞–ø—É—Å–∫ —Å–∏—Å—Ç–µ–º–∏

```bash
docker-compose up -d
```

### 3. –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Ä–æ–±–æ—Ç–∏

```bash
curl http://localhost/health
```

–û—á—ñ–∫—É–≤–∞–Ω–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥—å:
```json
{"status": "healthy"}
```

### 4. –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è API

- **Swagger UI**: http://localhost/docs

### –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –∑–∞–ª–µ–∂–Ω–æ—Å—Ç–µ–π, –ª–æ–∫–∞–ª—å–Ω–æ –¥–ª—è —Ä–æ–∑—Ä–æ–±–∫–∏

```bash
pip install -r requirements.txt
```

### –ó–∞–ø—É—Å–∫ –¥–æ–¥–∞—Ç–∫—É

```bash
python -m uvicorn ukma.betting_system.main:app --reload --host 0.0.0.0 --port 8000
```

## üê≥ Docker —Å–µ—Ä–≤—ñ—Å–∏

| –°–µ—Ä–≤—ñ—Å | –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä | –ü–æ—Ä—Ç | –û–ø–∏—Å |
|--------|-----------|------|------|
| nginx | sbs-nginx | 80 | Reverse proxy –¥–æ API —Å–µ—Ä–≤–µ—Ä—ñ–≤ |
| database-master | sbs-db-master | 5432 | PostgreSQL –º–∞–π—Å—Ç–µ—Ä –≤—É–∑–æ–ª |
| database-replica-1 | sbs-db-replica-1 | 5432 | PostgreSQL —Ä–µ–ø–ª—ñ–∫–∞ 1 |
| database-replica-2 | sbs-db-replica-2 | 5432 | PostgreSQL —Ä–µ–ø–ª—ñ–∫–∞ 2 |
| database-replica-3 | sbs-db-replica-3 | 5432 | PostgreSQL —Ä–µ–ø–ª—ñ–∫–∞ 3 |
| API Server 1 | sbs-server-1 | 8000 | FastAPI –¥–æ–¥–∞—Ç–æ–∫ 1 |
| API Server 2 | sbs-server-2 | 8000 | FastAPI –¥–æ–¥–∞—Ç–æ–∫ 2 |
| API Server 3 | sbs-server-3 | 8000 | FastAPI –¥–æ–¥–∞—Ç–æ–∫ 3 |

## üîå API –ï–Ω–¥–ø–æ—ñ–Ω—Ç–∏

| –ú–µ—Ç–æ–¥ | –ï–Ω–¥–ø–æ—ñ–Ω—Ç | –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—è | –û–ø–∏—Å |
|-------|----------|-------------|------|
| POST | /auth/signup | ‚ùå | –†–µ—î—Å—Ç—Ä–∞—Ü—ñ—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ |
| POST | /auth/login | ‚ùå | –í—Ö—ñ–¥, –æ—Ç—Ä–∏–º–∞–Ω–Ω—è JWT |
| GET | /events | ‚ùå | –°–ø–∏—Å–æ–∫ –≤—ñ–¥–∫—Ä–∏—Ç–∏—Ö –ø–æ–¥—ñ–π |
| POST | /events | ‚úÖ –ê–¥–º—ñ–Ω | –°—Ç–≤–æ—Ä–µ–Ω–Ω—è –ø–æ–¥—ñ—ó |
| GET | /events/{id} | ‚ùå | –î–µ—Ç–∞–ª—ñ –ø–æ–¥—ñ—ó |
| PATCH | /events/{id} | ‚úÖ –ê–¥–º—ñ–Ω | –û–Ω–æ–≤–ª–µ–Ω–Ω—è –ø–æ–¥—ñ—ó |
| DELETE | /events/{id} | ‚úÖ –ê–¥–º—ñ–Ω | –í–∏–¥–∞–ª–µ–Ω–Ω—è –ø–æ–¥—ñ—ó |
| GET | /health | ‚ùå | –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Å—Ç–∞–Ω—É —Å–∏—Å—Ç–µ–º–∏ |

## üîí –ë–µ–∑–ø–µ–∫–∞

- **–•–µ—à—É–≤–∞–Ω–Ω—è –ø–∞—Ä–æ–ª—ñ–≤**: Bcrypt
- **JWT –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—è**: JWT –∑ –æ–±–º–µ–∂–µ–Ω–∏–º —á–∞—Å–æ–º –¥—ñ—ó –¥–ª—è –æ–±–æ—Ö —Ç–∏–ø—ñ–≤ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤
- **–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—è**: –†–æ–ª—å–æ–≤–∏–π –∫–æ–Ω—Ç—Ä–æ–ª—å –¥–æ—Å—Ç—É–ø—É (–∫–æ—Ä–∏—Å—Ç—É–≤–∞—á, –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä)
- **–í–∞–ª—ñ–¥–∞—Ü—ñ—è**: Pydantic –º–æ–¥–µ–ª—ñ –¥–ª—è –≤–∞–ª—ñ–¥–∞—Ü—ñ—ó –º–æ–¥–µ–ª–µ–π –¥–∞–Ω–∏—Ö —É –∑–∞–ø–∏—Ç–∞—Ö

## üìã –í–∏–º–æ–≥–∏ –¥–æ —Å–∏—Å—Ç–µ–º–∏

- Docker & Docker Compose
- Python 3.11+ (Docker)
- PostgreSQL (Docker)

## Production deployment

–ü–µ—Ä–µ–¥ –¥–µ–ø–ª–æ–π–º–µ–Ω—Ç–æ–º –≤–∏–∫–æ–Ω–∞–π—Ç–µ —ñ–Ω—Å—Ç—Ä—É–∫—Ü—ñ—é:

1. **–ó–º—ñ–Ω—ñ—Ç—å SECRET_KEY** –≤ `.env` –Ω–∞ —Å–∏–ª—å–Ω–∏–π –≤–∏–ø–∞–¥–∫–æ–≤–∏–π —Ä—è–¥–æ–∫
2. **–ù–∞–ª–∞—à—Ç—É–π—Ç–µ CORS** –≤ `main.py` –¥–ª—è –≤–∞—à–æ–≥–æ –¥–æ–º–µ–Ω—É
3. **–ù–∞–ª–∞—à—Ç—É–π—Ç–µ SSL/TLS** –≤ Nginx
4. **–£–≤—ñ–º–∫–Ω—ñ—Ç—å –ª–æ–≥—É–≤–∞–Ω–Ω—è** —Ç–∞ –º–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥
5. **–ù–∞–ª–∞—à—Ç—É–π—Ç–µ –±–µ–∫–∞–ø–∏** –±–∞–∑–∏ –¥–∞–Ω–∏—Ö
6. **–†–µ–∞–ª—ñ–∑—É–π—Ç–µ rate limiting**
7. **–í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ —Å–∏–ª—å–Ω—ñ –ø–∞—Ä–æ–ª—ñ** –≤ `.env`

## üõ†Ô∏è –Ü–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏ —Ä–æ–∑—Ä–æ–±–∫–∏

### –î–æ—Å—Ç—É–ø –¥–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—ó API
- Swagger UI: `http://localhost/docs`
- ReDoc: `http://localhost/redoc`
- OpenAPI JSON: `http://localhost/openapi.json`

### –£–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –±–∞–∑–æ—é –¥–∞–Ω–∏—Ö
```bash
# –ü—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –¥–æ –º–∞–π—Å—Ç–µ—Ä –±–∞–∑–∏ –¥–∞–Ω–∏—Ö
docker-compose exec sbs-db-master psql -U username_from_creds -d database_from_creds

# –ü–µ—Ä–µ–≥–ª—è–¥ –ª–æ–≥—ñ–≤
docker-compose logs -f sbs-db-master
```

### –ó—É–ø–∏–Ω–∫–∞ —Å–µ—Ä–≤—ñ—Å—ñ–≤
```bash
docker-compose down
```

### –í–∏–¥–∞–ª–µ–Ω–Ω—è –≤—Å—ñ—Ö –¥–∞–Ω–∏—Ö
```bash
docker-compose down -v
```
